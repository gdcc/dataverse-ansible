# "local" is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            {{ db.postgres.auth }}
# IPv6 local connections:
host    all             all             ::1/128                 {{ db.postgres.auth }}

# replication and dataverse access from other servers
{% if db.postgres.replication.enabled is defined %}
{% for item in db.postgres.replication.servers %}
{% if item | regex_search(".*/.*") %}
host    all             all        {{ item }}      {{ db.postgres.auth }}
host    replication     rep        {{ item }}      {{ db.postgres.auth }}
{% else %}
host    all             all        {{ item }}/32      {{ db.postgres.auth }}
host    replication     rep        {{ item }}/32      {{ db.postgres.auth }}
{% endif %}
{% endfor %}
{% endif %}
